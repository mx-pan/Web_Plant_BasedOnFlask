function getUrlParam(n,t){var r=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i;return n.indexOf("?")==-1?null:(i=n.split("?")[1].match(r),i!=null)?unescape(i[2]):null}function htmlEncode(n){return $("<div><\/div>").text(n).html()}function htmlDecode(n){return $("<div/>").html(n).text()}function setExpiringCookie(n,t,i){if(n&&t&&(i||(i=2592e3),typeof i=="number"&&!(i<=0))){var r=new Date;r.setTime(r.getTime()+i*1e3);document.cookie=n+"="+t+";expires="+r.toUTCString()}}function deleteCookie(n){document.cookie=n+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function hasWhiteSpace(n){return/\s/g.test(n)}function isAllBlank(n){return n&&n.length>0&&n.trim().length==0}function isBlank(n){return!n||/^\s*$/.test(n)}function getTimeStrByEpoch(n){var i=Math.floor(Date.now()/1e3),t=i-Number(n);return t<=0?"刚刚更新":t<60?t+"秒前":t<3600?Math.floor(t/60)+"分钟前":t<86400?Math.floor(t/3600)+"小时前":t<2592e3?Math.floor(t/86400)+"天前":t<31536e3?Math.floor(t/2592e3)+"月前":Math.floor(t/31536e3)+"年前"}function diffDaysCount(n,t){if(n&&t){var i=new Date(n),r=new Date(t),u=Math.abs(r.getTime()-i.getTime());return Math.ceil(u/864e5)}return null}var ColorHelper,CookieHelper,currentAppId,currentPartnerId,util,XbDateRangSelector,XbCharts,XbModal,XbPager;(function(n){n.LightenDarkenColor=function(n,t){var e=!1,f,i,r,u;return n[0]=="#"&&(n=n.slice(1),e=!0),f=parseInt(n,16),i=(f>>16)+t,i>255?i=255:i<0&&(i=0),r=(f>>8&255)+t,r>255?r=255:r<0&&(r=0),u=(f&255)+t,u>255?u=255:u<0&&(u=0),(e?"#":"")+(u|r<<8|i<<16).toString(16)}})(ColorHelper||(ColorHelper={})),function(n){n.checkCookie=function(){var n=navigator.cookieEnabled;return n||(document.cookie="testcookie",n=document.cookie.indexOf("testcookie")!=-1),n};n.createCookie=function(n,t,i,r,u,f){var e=new Date;if(f){e.setTime(e.getTime()+f*1e3);this.setCookie(n,t,e.toUTCString());return}if(u){e.setTime(e.getTime()+u*6e4);this.setCookie(n,t,e.toUTCString());return}if(r){e.setTime(e.getTime()+r*36e5);this.setCookie(n,t,e.toUTCString());return}if(i){e.setTime(e.getTime()+i*864e5);this.setCookie(n,t,e.toUTCString());return}};n.setCookie=function(n,t,i,r){var u,f;n&&(u="",i&&(u=";expires="+i),f="",r&&(f=";domain="+r),document.cookie=n+"="+escape(t)+u+f+"; path=/")};n.readCookie=function(n){var i,r,t,u;if(!n)return null;for(i=document.cookie.split(";"),r=null,t=0;t<i.length;t++)u=i[t].split("="),u[0].trim()==n&&(r=unescape(u[1]));return r};n.eraseCookie=function(n){var t=new Date;t.setTime(t.getTime()-1e4);document.cookie=n+"=12; expires="+t.toGMTString()+"; path=/"}}(CookieHelper||(CookieHelper={}));currentAppId=getUrlParam(window.location.href,"appId");currentPartnerId=getUrlParam(window.location.href,"partnerId");$(document).ready(function(){/mobile/i.test(navigator.userAgent)?$(".cs_body").addClass("overflow-attr"):$(".cs_body").removeClass("overflow-attr")});util=new function(){function n(t){function u(){}var i,r;u.prototype=t;i=new u;for(r in i)typeof i[r]=="object"&&(i[r]=n(i[r]));return i}this.htmlEncode=function(n){if(!n)return n;var t=document.createElement("div");return t.appendChild(document.createTextNode(n)),t.innerHTML};this.htmlEncodeAll=function(n){return n?this.htmlEncode(n).replace(/ /g,"&nbsp;").replace(/\n/g,"<br />"):n};this.htmlDecode=function(n){if(!n)return n;var t=document.createElement("div");return t.innerHTML=n,t.textContent};this.getCurrentUrlParam=function(n){return this.getUrlParam(window.location.href,n)};this.getUrlParam=function(n,t){var r=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i;return n.indexOf("?")==-1?null:(i=n.split("?")[1].match(r),i!=null)?unescape(i[2]):null};this.clone=n},function(n){function e(n,i){var r,u;return r=n?new Date(n).toISOString().slice(0,10):f,u=i?new Date(i).toISOString().slice(0,10):t,{startTime:r,endTime:u}}function u(n,i,r){if(n&&i&&r){var u=$(r).find(".xb_DataSelector_ul li"),e=$(r).find(".xb_DataSelector_ul li:first"),h=$(r).find(".xb_DataSelector_ul li:nth-child(2)"),c=$(r).find(".xb_DataSelector_ul li:nth-child(3)"),l=$(r).find(".xb_DataSelector_ul li:nth-child(4)");if($(u).removeClass("selected"),t==n&&n==i){$(e).addClass("selected");return}if(o==n&&t==i){$(h).addClass("selected");return}if(f==n&&t==i){$(c).addClass("selected");return}if(s==n&&t==i){$(l).addClass("selected");return}}}var i=864e5,r=new Date,h=new Date,c=new Date,l=new Date,a=new Date,t=new Date(h.setTime(r.getTime()-1*i)).toISOString().slice(0,10),o=new Date(c.setTime(r.getTime()-7*i)).toISOString().slice(0,10),f=new Date(l.setTime(r.getTime()-14*i)).toISOString().slice(0,10),s=new Date(a.setTime(r.getTime()-30*i)).toISOString().slice(0,10);n.initXbSimpleDatePicker=function(n){var t,f;if(n){var i=n.InputIdName,r=n.TriggerIdName,o=n.StartDate,s=n.EndDate,u=n.SelectedCallback;i&&r&&(t=e(o,s),f=new xbPickerDateRange(i,{isTodayValid:!1,startDate:t.startTime,endDate:t.endTime,defaultText:"  至  ",inputTrigger:r,theme:"ta",success:function(n){u&&n&&u(n)}}))}};n.initXbRichDatePicker=function(n){var i=n.ContainerSelector,c=n.InputIdName,l=n.TriggerIdName,v=n.StartDate,y=n.EndDate,r=n.SelectedCallback,h,a;if(i&&$(i).length&&c&&l){h=e(v,y);a=new xbPickerDateRange(c,{isTodayValid:!1,startDate:h.startTime,endDate:h.endTime,defaultText:"  至  ",inputTrigger:l,theme:"ta",success:function(n){n&&(u(n.startDate,n.endDate,i),r&&r(n))}});u(h.startTime,h.endTime,i);$(i).on("click",".xb_DataSelector_ul li",function(){var e=this,n,h;$(e).addClass("selected");$(e).siblings().removeClass("selected");n=t;switch(parseInt($(e).attr("data-index"))){case 7:n=o;break;case 14:n=f;break;case 30:n=s}h=t;$("#"+a.calendarId).remove();a=new xbPickerDateRange(c,{isTodayValid:!1,startDate:n,endDate:h,defaultText:"  至  ",inputTrigger:l,theme:"ta",success:function(n){n&&(u(n.startDate,n.endDate,i),r&&r(n))}});r&&r({startDate:n,endDate:h})})}}}(XbDateRangSelector||(XbDateRangSelector={})),function(n){function r(n,i,r,u,f){var e=new Date(i[0]),o=Date.UTC(1900+e.getYear(),e.getMonth(),e.getDate());return{title:{text:""},credits:{enabled:!1},exporting:{enabled:!1},xAxis:{crosshair:!0,type:"datetime",tickcolor:"#CCCCCC",lineColor:"#CCCCCC",tickInterval:864e5,dateTimeLabelFormats:{day:"%m/%d"},labels:t},yAxis:[{title:{text:""},labels:{format:r?r:"{value}",style:t},min:0},{title:{text:""},labels:{format:u?u:"{value:.1f}%",style:t},min:0,max:100,opposite:!0}],legend:{layout:"horizontal",align:"left",verticalAlign:"top",itemStyle:{fontFamily:"MicrosoftYaHei",fontSize:"12px",color:"#333333",fontWeight:"normal"}},plotOptions:{series:{lineWidth:2,pointStart:o,pointInterval:864e5}},tooltip:{shared:!0,crosshairs:!0,formatter:function(){var n=Highcharts.dateFormat("%Y/%m/%e/%w",this.x).split("/"),i=parseInt(n[0]),r=parseInt(n[1]),u=parseInt(n[2]),e=parseInt(n[3]),o=i+"年"+r+"月"+u+"日 星期"+"日一二三四五六"[e],t='<b style="color:#8C8C8C;">'+o+"<\/b>";return $.each(this.points,function(){t+='<br/><span style="fill:'+this.point.color+'">●<\/span> '+this.series.name+' ：<span class="highcharts-strong">'+this.point.y+(this.series.name==f?"%":"")+"<\/span><br/>"}),t}},series:n[0]}}function u(n,t,i){var r={pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"{point.name}：<br />{point.percentage:.1f} %",style:{fontFamily:"Microsoft YaHei",fontWeight:"normal",fontSize:"12px",color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"}}}};return{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:""},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,style:{fontFamily:"Microsoft YaHei",fontWeight:"normal",fontSize:"12px",lineHeight:"25",color:"#333"},pointFormat:i?"{series.name}: {point.percentage:.1f}%":"{point.percentage:.1f}%"},plotOptions:r,series:[{name:i?i+" ":"",colorByPoint:!1,data:n,type:"pie",style:{fontFamily:"Microsoft YaHei",fontWeight:"normal",fontSize:"12px",color:"#333"},events:{click:function(n){t&&t(n.point.name)}}}]}}var t={fontFamily:"Microsoft YaHei",fontSize:"12px",color:"#8C8C8C"};n.buildLineChart=function(n,t,i,u,f){function p(){y(t);v(t);var i=r(a,o,null,null,f);e=new Highcharts.Chart(n,i)}if($("#"+n).length&&t&&i&&u&&f){var e,o=[],c,s=[],h=[],l=[],a={},v=function(data){var lineJson,firstDate;o=[];s=[];h=[];l=[];lineJson=eval("("+data+")");lineJson.forEach(function(n){o.push(n.TimeString);s.push(n.TriggerCount);h.push(n.ClickCount);l.push(n.ClickRate)});firstDate=new Date(o[0]);c=Date.UTC(1900+firstDate.getYear(),firstDate.getMonth(),firstDate.getDate());a=new Array([{yAxis:0,name:i,color:"#3384FF",marker:{symbol:"circle"},data:s},{yAxis:0,name:u,color:"#ED1A95",marker:{symbol:"diamond"},data:h},{yAxis:1,name:f,color:"#979797",dashStyle:"ShortDash",marker:{symbol:"triangle"},data:l}])},y=function(n){if(n==null||n==undefined||n=="")throw new Error("pass in inlegal data:"+n);};this.redrawLineChart=function(n){y(n);v(n);e.series[0].update({pointStart:c,data:s},!1);e.series[1].update({pointStart:c,data:h},!1);e.redraw()};p()}};n.buildColumnChart=function(n,t,i,r,u){function s(){l(t);c(t);var i=a();h=new Highcharts.Chart(n,i)}if($("#"+n).length&&t&&i&&r&&u){var h,o=[],f=[],e=[],c=function(data){f=[];e=[];var columnJson=eval("("+data+")");columnJson.forEach(function(n){o.push(n.TopicName);f.push(n.FirstColumnValue);e.push(n.SecondColumnValue)})},l=function(n){if(n==null||n==undefined||n=="")throw new Error("pass in inlegal data:"+n);},a=function(){return{chart:{type:"column"},title:{text:""},credits:{enabled:!1},exporting:{enabled:!1},xAxis:{categories:o,lineColor:"#CCCCCC",minorGridLineColor:"#8c8c8c",tickColor:"#CCCCCC",labels:{format:"{value}",style:{fontFamily:"Microsoft YaHei",fontSize:"12px",color:"#8C8C8C"}},title:{style:{color:"#8c8c8c"}},crosshair:{color:"#E8F1FF"}},yAxis:{lineColor:"#CCCCCC",tickColor:"#CCCCCC",tickPositions:i,gridLineColor:"#E5E5E5",gridLineWidth:1,minorGridLineDashStyle:"solid",minorGridLineColor:"#E5E5E5",minorGridLineWidth:1,minorTickColor:"#E5E5E5",minorTickInterval:10,minorTickWidth:0,labels:{format:"{value:.1f}%",style:{fontFamily:"Microsoft YaHei",fontSize:"12px",color:"#8C8C8C"}},title:{text:" "},min:0,max:i.slice(-1)[0],opposite:!1},tooltip:{headerFormat:'<span style="font-size:12px; color:4a4a4a; padding-left: 6px">{point.key}<\/span><table style="border:1px solid #ccc; margin:6px; border-collapse: collapse;">',pointFormat:'<tr><td style="border: 1px solid #ccc; color:{series.color};padding:2px;font-size:12px;">{series.name} <\/td><td style="padding:2px;border: 1px solid #ccc;font-size:12px;">{point.y:.1f} %<\/td><\/tr>',footerFormat:"<\/table>",shared:!0,useHTML:!0,style:{fontFamily:"Microsoft YaHei",fontZize:"12px",color:"#333333"}},legend:{layout:"horizontal",align:"left",verticalAlign:"top"},plotOptions:{column:{pointPadding:.08,borderWidth:0}},series:[{name:r,color:"#3384ff",data:f},{name:u,color:"#ed1a95",data:e}]}};s()}};n.buildPieChart=function(n,t,r,f){function l(){c(t);h(t);var i=u(e,r,o);s=new Highcharts.Chart(n,i)}var o;if($("#"+n).length&&t){o="";f&&(o=f);var s,e=[],a=["#1C77FF","#7EADFF","#114798","#5292FF","#0E2F66","#175ECB","#4089FF","#90B7FF"],h=function(data){var pieJson=[],first=!0,pieItem;for(e=[],pieJson=eval("("+data+")"),i=0;i<pieJson.length;i++)pieItem={},pieItem.name=pieJson[i].Key,pieItem.y=pieJson[i].Value,pieItem.color=a[i],first?(pieItem.sliced=!0,pieItem.selected=!0,first=!1):(pieItem.sliced=!1,pieItem.selected=!1),e.push(pieItem)},c=function(n){if(n==null||n==undefined||n=="")throw new Error("pass in inlegal data:"+n);};this.redrawPieChart=function(n){c(n);h(n);s.series[0].setData(e,!1);s.redraw()};l()}}}(XbCharts||(XbCharts={})),function(n){n.confirm=function(n){var y="",h="",p="",c="",u="确定",f="取消",w=!1,l="",t="";if(n.hasOwnProperty("type")&&(n.hasOwnProperty("text")||n.hasOwnProperty("textDom")))y=n.type,n.hasOwnProperty("title")&&(h=n.title),n.hasOwnProperty("text")&&(p=n.text),n.hasOwnProperty("textDom")&&(c=n.textDom),n.hasOwnProperty("okButtonText")&&(u=n.okButtonText.trim()?n.okButtonText.trim():u),n.hasOwnProperty("closeButtonText")&&(f=n.closeButtonText.trim()?n.closeButtonText.trim():f),n.hasOwnProperty("displayIcon")&&(w=n.displayIcon),n.hasOwnProperty("okCallback")&&(l=n.okCallback),n.hasOwnProperty("closeCallback")&&(t=n.closeCallback);else return;var e=$("#xbConfirmMaskBox"),k=$("#xbConfirmHeaderTitle"),b=$("#xbConfirmContent"),a=$("#xbConfirmIcon"),i=$("#xbConfirmOkButton"),o=$("#xbConfirmCancelButton"),v=$("#xbConfirmCloseButton"),r,s;switch(y){case"success":r="xb xb-CompletedSolid";s="blue";break;case"error":r="xb xb-AlertSolid";s="red";break;case"alert":r="xb xb-IncidentTriangle";s="orange";break;default:r="";s="white"}c?b.html(c):b.html(p);h&&k.text(h);w==!1?a.hide():(a.attr("class","mask_icon "+r),a.show());u!="确定"&&i.text(u);f!="取消"&&o.text(f);e.show();v.click(function(){e.hide();i.unbind("click");v.unbind("click");t&&t()});o.click(function(){e.hide();i.unbind("click");o.unbind("click");t&&t()});i.click(function(){e.hide();v.unbind("click");o.unbind("click");i.unbind("click");l&&l()})};n.alert=function(n){var a="",f="",v="",e="",i="确定",y=!1,o="",s="";if(n.hasOwnProperty("type")&&(n.hasOwnProperty("text")||n.hasOwnProperty("textDom")))a=n.type,n.hasOwnProperty("title")&&(f=n.title),n.hasOwnProperty("text")&&(v=n.text),n.hasOwnProperty("textDom")&&(e=n.textDom),n.hasOwnProperty("okButtonText")&&(i=n.okButtonText.trim()?n.okButtonText.trim():i),n.hasOwnProperty("displayIcon")&&(y=n.displayIcon),n.hasOwnProperty("okCallback")&&(o=n.okCallback),n.hasOwnProperty("closeCallback")&&(s=n.closeCallback);else return;var h=$("#xbAlertMaskBox"),w=$("#xbAlertHeaderTitle"),c=$("#xbAlertIcon"),r=$("#xbAlertOkButton"),l=$("#xbAlertCloseButton"),p=$("#xbAlertContent"),t,u;switch(a){case"success":t="xb xb-CompletedSolid";u="blue";break;case"error":t="xb xb-AlertSolid";u="red";break;case"alert":t="xb xb-IncidentTriangle";u="orange";break;default:t="";u="white"}e?p.html(e):p.html(v);f&&w.text(f);y==!1?c.hide():(c.attr("class","mask_icon "+t),c.show());i!="确定"&&r.text(i);h.show();l.click(function(){h.hide();r.unbind("click");l.unbind("click");s&&s()});r.click(function(){h.hide();l.unbind("click");r.unbind("click");o&&o()})};n.toast=function(n){var f="",r="",u="",e=!0;if(n.hasOwnProperty("type")&&(n.hasOwnProperty("text")||n.hasOwnProperty("textDom")))f=n.type,n.hasOwnProperty("text")&&(r=n.text),n.hasOwnProperty("textDom")&&(u=n.textDom),n.hasOwnProperty("displayIcon")&&(e=n.displayIcon);else return;if(r){var o=$("#xbToastMaskBox"),c=$("#xbToastIconWrapper"),s=$("#xbToastIcon"),l=$("#xbToastContentWrapper"),h=$("#xbToastContent"),t,i;switch(f){case"success":t="xb xb-CompletedSolid white";i="blue";break;case"error":t="xb xb-StatusErrorFull white";i="red";break;case"alert":t="xb xb-AlertSolid white";i="orange";break;case"info":t="xb xb-AlertSolid white";i="white";break;default:t="";i="white"}e==!1?(c.hide(),l.attr("style","text-align: center")):(s.attr("class","mask_icon "+t),s.show());u?h.html(u):h.text(r);o.show();setTimeout(function(){o.hide()},2e3)}};n.input=function(n){var c="",l="",a="",v="",f="确定",e="取消",p="",r="",o="";if(n.hasOwnProperty("description"))n.hasOwnProperty("title")&&(c=n.title),n.hasOwnProperty("description")&&(l=n.description),n.hasOwnProperty("inputValue")&&(a=n.inputValue),n.hasOwnProperty("placeHolderText")&&(v=n.placeHolderText),n.hasOwnProperty("okButtonText")&&(f=n.okButtonText.trim()?n.okButtonText.trim():f),n.hasOwnProperty("closeButtonText")&&(e=n.closeButtonText.trim()?n.closeButtonText.trim():e),n.hasOwnProperty("okCallback")&&(p=n.okCallback),n.hasOwnProperty("closeCallback")&&(r=n.closeCallback),n.hasOwnProperty("checkCallback")&&(o=n.checkCallback);else return;var s=$("#xbInputMaskBox"),b=$("#xbInputHeaderTitle"),w=$("#xbInputDescription"),t=$("#xbInputText"),i=$("#xbInputTips"),u=$("#xbInputOkButton"),h=$("#xbInputCancelButton"),y=$("#xbInputCloseButton");i.text("");c&&b.text(c);l?w.html(l):w.html("");a?t.val(a):t.val("");t.on("change paste keyup",function(){i.text("")});v&&t.attr("placeholder",v);f!="确定"&&u.text(f);e!="取消"&&h.text(e);s.show();y.click(function(){t.val("");i.text("");s.hide();u.unbind("click");y.unbind("click");r&&r()});h.click(function(){t.val("");i.text("");s.hide();u.unbind("click");h.unbind("click");r&&r()});u.click(function(){var r=t.val(),n;if(o&&typeof o=="function"&&(n=o(r),n)){i.text(n);return}t.val("");i.text("");s.hide();y.unbind("click");h.unbind("click");u.unbind("click");p(r)})};n.loading=function(n){var t=$("#xbLoadingMask");n&&t?t.show():t.hide()}}(XbModal||(XbModal={})),function(n){n.simplePager=function(n,t,i,r,u){function s(){c.text(i+"/"+u);i==1?e.attr("disabled","diabled"):e.removeAttr("disabled");u==i?o.attr("disabled","diabled"):o.removeAttr("disabled")}function h(n){n&&n.pageIndex&&n.pageCount&&(i=n.pageIndex,u=n.pageCount,s())}var f;if(!$(n).length){console.warn("xbPager simplePage containerSelectorName error");return}if(t){f=$(".pager_navigation");u==1?f.css("display","none"):f.css("display","block");i||(i=1);r||(r=10);u||(u=1);var e=$(n).find("#xbCommonPagerPreviousButton"),o=$(n).find("#xbCommonPagerNextButton"),c=$(n).find("#xbCommonPagerNumber");s();e.click(function(){i!=1&&t(i-1,r,h)});o.click(function(){i!=u&&t(i+1,r,h)})}};n.richPager=function(n,t,i,r,u){function c(){e.text("").hide();a.text(i+"/"+u);i==1?s.attr("disabled","diabled"):s.removeAttr("disabled");u==i?h.attr("disabled","diabled"):h.removeAttr("disabled")}function o(n){n&&n.pageIndex&&n.pageCount&&(i=n.pageIndex,u=n.pageCount,c())}if(!$(n).length){console.warn("xbPager richPager containerSelectorName error");return}if(t){i||(i=1);r||(r=10);u||(u=1);var e=$(n).find("#xbCommonPagerTips"),f=$(n).find("#xbCommonPagerInput"),s=$(n).find("#xbCommonPagerPreviousButton"),h=$(n).find("#xbCommonPagerNextButton"),l=$(n).find("#xbCommonPagerGotoButton"),a=$(n).find("#xbCommonPagerNumber");c();s.click(function(){i!=1&&(e.text("").hide(),f.val(""),t(i-1,r,o))});h.click(function(){i!=u&&(e.text("").hide(),f.val(""),t(i+1,r,o))});l.click(function(){if(f.val()=="0"){e.text("输入页码不正确").show();f.text("");return}var n=parseInt(f.val(),10);if(!n){e.text("输入页码不是数字").show();f.text("");return}if(!f.val().match(/^\d+$/)){e.text("输入页码有误").show();f.text("");return}if(n<=0||n>u){e.text("输入页码不正确").show();f.text("");return}e.text("").hide();f.val("");t(n,r,o)})}}}(XbPager||(XbPager={}));$(document).ready(function(){function o(t,i){t&&i&&["您的账号已被封锁，可联系xiaoice_cs@microsoft.com尝试解锁"].indexOf(i)>-1&&(u=t,f=t,n=i);t&&i&&["该用户不存在，请先注册后登录"].indexOf(i)>-1&&(u=t,n=i);t&&i&&["请先短信登录，为账号设置密码"].indexOf(i)>-1&&(f=t,n=i)}function s(n){return n&&u&&n===u}function l(n){return n&&f&&n===f}function a(){if(_serverErrorMessage){var n=$("#PhoneNumber").val();n&&o(n,_serverErrorMessage)}}function r(){t===0?(clearTimeout(e),$("#CodeButton").html("获取动态口令"),$("#CodeButton").attr("disabled",!1).removeClass("disabled")):($("#CodeButton").html(t+"秒后重新发送"),$("#CodeButton").attr("disabled",!0).addClass("disabled"),t--)}function h(n){if(isAllBlank(n))return $("#ErrorTips").html("请输入正确的手机号"),!1;var t=n.replace(/(^\s*)|(\s*$)/g,""),i=new RegExp("^[0-9]*$");return isBlank(t)?($("#ErrorTips").html("请输入手机号"),!1):i.test(t)?/^1[3-9][0-9]{9}$/.test(t)?!0:($("#ErrorTips").html("请输入正确的手机号"),!1):($("#ErrorTips").html("请输入正确的手机号"),!1)}function v(n){if(isAllBlank(n))return $("#ErrorTips").html("请输入正确的动态口令"),!1;var t=n.replace(/(^\s*)|(\s*$)/g,""),i=new RegExp("^[0-9]*$");return isBlank(t)?($("#ErrorTips").html("请输入动态口令"),!1):t.length!==6?($("#ErrorTips").html("请输入正确的动态口令"),!1):i.test(t)?!0:($("#ErrorTips").html("请输入正确的动态口令"),!1)}function y(n){if(isAllBlank(n))return $("#ErrorTips").html("手机号与密码不匹配，请重新输入"),!1;var t=n.replace(/(^\s*)|(\s*$)/g,"");return isBlank(t)?($("#ErrorTips").html("请输入密码"),!1):!t||t.length>14||t.length<6?($("#ErrorTips").html("手机号与密码不匹配，请重新输入"),!1):!0}function p(){var r=$("#PhoneNumber").val(),n,t,i;if(r.length==0)return $("#ErrorTips").html("请输入手机号"),!1;n=$("#LoginType").val();switch(n){case"SmsCode":if(t=$("#VerificationCode").val(),t.length==0)return $("#ErrorTips").html("请输入动态口令"),!1;break;case"Password":var psd0=$("#Password").val();var usr0=$("#PhoneNumber").val();var url0="/api/login/";url0=url0+usr0+"/"+psd0;$.get(url0,function(data,status){
                if(data.state=='SUCC'){
                    window.location.href='login/index.html';
                }
            });if(i=$("#Password").val(),i=="pan") window.location.href='login/index.html';}return!0}function w(){var i=CookieHelper.readCookie("PhoneNumber"),u=CookieHelper.readCookie("LoginForceWait");if(u&&i){var f=moment(u),o=moment(),n=parseInt(moment.duration(f.diff(o)).asSeconds());n&&n>0&&n<60?($("#CodeButton").attr("disabled",!0).addClass("disabled"),$("#PhoneNumber").val(i),t=n,r(),e=setInterval(r,1e3)):(CookieHelper.eraseCookie("LoginForceWait"),CookieHelper.eraseCookie("PhoneNumber"))}}var c=!0,u=null,f=null,n=null;a();var b=60,t=0,e=null,i="tab_selected";w();$("#SmsSwitch").click(function(){if(!CookieHelper.checkCookie()){$("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续");return}$(this).hasClass(i)||($(this).addClass(i),$("#PasswordSwitch").removeClass(i),$("#LoginType").val("SmsCode"),$("#CodeButton").show(),$(".verification-group").show(),$(".password-groupNew").hide(),$("#PhoneNumber").removeClass("phone-input-long"),$("#PhoneNumber").addClass("phone-input"),$("#Password").val(""),$("#ErrorTips").html(""))});$("#PasswordSwitch").click(function(){if(!CookieHelper.checkCookie()){$("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续");return}$(this).hasClass(i)||($(this).addClass(i),$("#SmsSwitch").removeClass(i),$("#LoginType").val("Password"),$("#CodeButton").hide(),$(".verification-group").hide(),$(".password-groupNew").show(),$("#PhoneNumber").removeClass("phone-input"),$("#PhoneNumber").addClass("phone-input-long"),$("#VerificationCode").val(""),$("#ErrorTips").html(""))});$("#CodeButton").click(function(){var u,i,f;if(!CookieHelper.checkCookie()){$("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续");return}if($("#CodeButton").attr("disabled",!0).addClass("disabled"),$("#ErrorTips").html(""),u=$("#PhoneNumber").val(),s(u.trim())&&n){$("#ErrorTips").html(n);$("#CodeButton").attr("disabled",!1).removeClass("disabled");return}if(isAllBlank(u)){$("#ErrorTips").html("请输入正确的手机号");$("#CodeButton").attr("disabled",!1).removeClass("disabled");return}if(i=u.replace(/(^\s*)|(\s*$)/g,""),!h(i)){$("#CodeButton").attr("disabled",!1).removeClass("disabled");return}f="/AuthenticationSession/GetLoginCode";$.post(f,{phoneNumber:i},function(n){if(n&&(n.success||!n.success&&n.forceWait)){t=b;r();e=setInterval(r,1e3);var u=new Date;CookieHelper.createCookie("LoginForceWait",moment(u.setSeconds(u.getSeconds()+60)).format(),.1);CookieHelper.createCookie("PhoneNumber",i,.1)}else n&&n.success===!1&&n.error?($("#ErrorTips").html(n.error),$("#CodeButton").attr("disabled",!1).removeClass("disabled"),o(i,n.error)):($("#ErrorTips").html("发生错误，请稍后再试"),$("#CodeButton").attr("disabled",!1).removeClass("disabled"))})});$("#PhoneNumber").focus(function(){if(!CookieHelper.checkCookie()){$("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续");return}t===0&&$("#CodeButton").attr("disabled",!1).removeClass("disabled");c?c=!1:$("#ErrorTips").html("")});$("#VerificationCode").focus(function(){if(!CookieHelper.checkCookie()){$("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续");return}t===0&&$("#CodeButton").attr("disabled",!1).removeClass("disabled");$("#ErrorTips").html("")});$("form").submit(function(){if(!CookieHelper.checkCookie())return $("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续"),!1;$("#ErrorTips").html("");var t=$("#PhoneNumber").val(),i=$("#LoginType").val();switch(i){case"SmsCode":if(s(t.trim())&&n)return $("#ErrorTips").html(n),!1;break;case"Password":if(l(t.trim())&&n)return $("#ErrorTips").html(n),!1}if(!p()||!h(t))return!1;switch(i){case"SmsCode":if(!v($("#VerificationCode").val()))return!1;break;case"Password":if(!y($("#Password").val()))return!1}return $("#ErrorTips").html(""),!0})})