function getUrlParam(n,t){var r=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i;return n.indexOf("?")==-1?null:(i=n.split("?")[1].match(r),i!=null)?unescape(i[2]):null}function htmlEncode(n){return $("<div><\/div>").text(n).html()}function htmlDecode(n){return $("<div/>").html(n).text()}function setExpiringCookie(n,t,i){if(n&&t&&(i||(i=2592e3),typeof i=="number"&&!(i<=0))){var r=new Date;r.setTime(r.getTime()+i*1e3);document.cookie=n+"="+t+";expires="+r.toUTCString()}}function deleteCookie(n){document.cookie=n+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function hasWhiteSpace(n){return/\s/g.test(n)}function isAllBlank(n){return n&&n.length>0&&n.trim().length==0}function isBlank(n){return!n||/^\s*$/.test(n)}function getTimeStrByEpoch(n){var i=Math.floor(Date.now()/1e3),t=i-Number(n);return t<=0?"刚刚更新":t<60?t+"秒前":t<3600?Math.floor(t/60)+"分钟前":t<86400?Math.floor(t/3600)+"小时前":t<2592e3?Math.floor(t/86400)+"天前":t<31536e3?Math.floor(t/2592e3)+"月前":Math.floor(t/31536e3)+"年前"}function diffDaysCount(n,t){if(n&&t){var i=new Date(n),r=new Date(t),u=Math.abs(r.getTime()-i.getTime());return Math.ceil(u/864e5)}return null}var ColorHelper,CookieHelper,currentAppId,currentPartnerId,util;(function(n){n.LightenDarkenColor=function(n,t){var e=!1,f,i,r,u;return n[0]=="#"&&(n=n.slice(1),e=!0),f=parseInt(n,16),i=(f>>16)+t,i>255?i=255:i<0&&(i=0),r=(f>>8&255)+t,r>255?r=255:r<0&&(r=0),u=(f&255)+t,u>255?u=255:u<0&&(u=0),(e?"#":"")+(u|r<<8|i<<16).toString(16)}})(ColorHelper||(ColorHelper={})),function(n){n.checkCookie=function(){var n=navigator.cookieEnabled;return n||(document.cookie="testcookie",n=document.cookie.indexOf("testcookie")!=-1),n};n.createCookie=function(n,t,i,r,u,f){var e=new Date;if(f){e.setTime(e.getTime()+f*1e3);this.setCookie(n,t,e.toUTCString());return}if(u){e.setTime(e.getTime()+u*6e4);this.setCookie(n,t,e.toUTCString());return}if(r){e.setTime(e.getTime()+r*36e5);this.setCookie(n,t,e.toUTCString());return}if(i){e.setTime(e.getTime()+i*864e5);this.setCookie(n,t,e.toUTCString());return}};n.setCookie=function(n,t,i,r){var u,f;n&&(u="",i&&(u=";expires="+i),f="",r&&(f=";domain="+r),document.cookie=n+"="+escape(t)+u+f+"; path=/")};n.readCookie=function(n){var i,r,t,u;if(!n)return null;for(i=document.cookie.split(";"),r=null,t=0;t<i.length;t++)u=i[t].split("="),u[0].trim()==n&&(r=unescape(u[1]));return r};n.eraseCookie=function(n){var t=new Date;t.setTime(t.getTime()-1e4);document.cookie=n+"=12; expires="+t.toGMTString()+"; path=/"}}(CookieHelper||(CookieHelper={}));currentAppId=getUrlParam(window.location.href,"appId");currentPartnerId=getUrlParam(window.location.href,"partnerId");$(document).ready(function(){/mobile/i.test(navigator.userAgent)?$(".cs_body").addClass("overflow-attr"):$(".cs_body").removeClass("overflow-attr")});util=new function(){function n(t){function u(){}var i,r;u.prototype=t;i=new u;for(r in i)typeof i[r]=="object"&&(i[r]=n(i[r]));return i}this.htmlEncode=function(n){if(!n)return n;var t=document.createElement("div");return t.appendChild(document.createTextNode(n)),t.innerHTML};this.htmlEncodeAll=function(n){return n?this.htmlEncode(n).replace(/ /g,"&nbsp;").replace(/\n/g,"<br />"):n};this.htmlDecode=function(n){if(!n)return n;var t=document.createElement("div");return t.innerHTML=n,t.textContent};this.getCurrentUrlParam=function(n){return this.getUrlParam(window.location.href,n)};this.getUrlParam=function(n,t){var r=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i;return n.indexOf("?")==-1?null:(i=n.split("?")[1].match(r),i!=null)?unescape(i[2]):null};this.clone=n};$(document).ready(function(){function f(n,i){n&&i&&["该用户不存在，请先注册后登录","手机号已注册，请直接登录","请先短信登录，为账号设置密码"].indexOf(i)>-1&&(r=n,t=i)}function e(n){return n&&r&&n===r}function s(){if(_serverErrorMessage){var n=$("#PhoneNumber").val();n&&f(n,_serverErrorMessage)}}function i(){n===0?(clearTimeout(u),$("#CodeButton").html("获取动态口令"),$("#CodeButton").attr("disabled",!1).removeClass("disabled")):($("#CodeButton").html(n+"秒后重新发送"),$("#CodeButton").attr("disabled",!0).addClass("disabled"),n--)}function o(n){if(isAllBlank(n))return $("#ErrorTips").html("请输入正确的手机号"),!1;var t=n.replace(/(^\s*)|(\s*$)/g,""),i=new RegExp("^[0-9]*$");return isBlank(t)?($("#ErrorTips").html("请输入手机号"),!1):i.test(t)?/^1[3-9][0-9]{9}$/.test(t)?!0:($("#ErrorTips").html("请输入正确的手机号"),!1):($("#ErrorTips").html("请输入正确的手机号"),!1)}function h(n){if(isAllBlank(n))return $("#ErrorTips").html("请输入正确的动态口令"),!1;var t=n.replace(/(^\s*)|(\s*$)/g,""),i=new RegExp("^[0-9]*$");return isBlank(t)?($("#ErrorTips").html("请输入动态口令"),!1):t.length!==6?($("#ErrorTips").html("请输入正确的动态口令"),!1):i.test(t)?!0:($("#ErrorTips").html("请输入正确的动态口令"),!1)}function c(){var t=$("#PhoneNumber").val(),n;return t.length==0?($("#ErrorTips").html("请输入手机号"),!1):(n=$("#VerificationCode").val(),n.length==0)?($("#ErrorTips").html("请输入动态口令"),!1):!0}function l(){var r=CookieHelper.readCookie("PhoneNumber"),f=CookieHelper.readCookie("RegisterForceWait");if(f&&r){var e=moment(f),o=moment(),t=parseInt(moment.duration(e.diff(o)).asSeconds());t&&t>0&&t<60?($("#CodeButton").attr("disabled",!0).addClass("disabled"),$("#PhoneNumber").val(r),n=t,i(),u=setInterval(i,1e3)):(CookieHelper.eraseCookie("RegisterForceWait"),CookieHelper.eraseCookie("PhoneNumber"))}}var r=null,t=null;s();var a=60,n=0,u=null;l();$("#PhoneNumber").focus(function(){if(!CookieHelper.checkCookie()){$("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续");return}n===0&&$("#CodeButton").attr("disabled",!1).removeClass("disabled");$("#ErrorTips").html("")});$("#VerificationCode").focus(function(){if(!CookieHelper.checkCookie()){$("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续");return}n===0&&$("#CodeButton").attr("disabled",!1).removeClass("disabled");$("#ErrorTips").html("")});$("#CodeButton").click(function(){var s,r,h;if(!CookieHelper.checkCookie()){$("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续");return}if($("#CodeButton").attr("disabled",!0).addClass("disabled"),$("#ErrorTips").html(""),s=$("#PhoneNumber").val(),e(s.trim())&&t){$("#ErrorTips").html(t);$("#CodeButton").attr("disabled",!1).removeClass("disabled");return}if(isAllBlank(s)){$("#ErrorTips").html("请输入正确的手机号");$("#CodeButton").attr("disabled",!1).removeClass("disabled");return}if(r=s.replace(/(^\s*)|(\s*$)/g,""),!o(r)){$("#CodeButton").attr("disabled",!1).removeClass("disabled");return}h="/AuthenticationRegister/GetRegisterCode";$.post(h,{phoneNumber:r},function(t){if(t&&(t.success||!t.success&&t.forceWait)){n=a;i();u=setInterval(i,1e3);var e=new Date;CookieHelper.createCookie("RegisterForceWait",moment(e.setSeconds(e.getSeconds()+60)).format(),.1);CookieHelper.createCookie("PhoneNumber",r,.1)}else t&&t.success===!1&&t.error?($("#ErrorTips").html(t.error),$("#CodeButton").attr("disabled",!1).removeClass("disabled"),f(r,t.error)):($("#ErrorTips").html("发生错误，请稍后再试"),$("#CodeButton").attr("disabled",!1).removeClass("disabled"))})});$("form").submit(function(){if(!CookieHelper.checkCookie())return $("#ErrorTips").html("您的浏览器未启用cookie，请开启后再继续"),!1;$("#ErrorTips").html("");var n=$("#PhoneNumber").val(),i=$("#VerificationCode").val();return e(n.trim())&&t?($("#ErrorTips").html(t),!1):c()?o(n)?h(i)?($("#ErrorTips").html(""),!0):!1:!1:!1})})